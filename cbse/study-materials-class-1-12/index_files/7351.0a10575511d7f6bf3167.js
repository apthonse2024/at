"use strict";(self.webpackChunk_scribd_app_monolith=self.webpackChunk_scribd_app_monolith||[]).push([[7351],{21097:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function a(t){try{u(i.next(t))}catch(t){s(t)}}function r(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}u((i=i.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function r(s){return function(r){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&s[0]?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],i=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,r])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(63785),r=n(10191),u=s(n(19800)),l=s(n(62517)),d=n(46162),c=function(){function t(t,e,n){var i;this.platform=null,this.nativeModules=null,this.sdkType="js-client",this.reactNativeUUID=n,this.user=t,this.sdkVersion=d.version,this.statsigMetadata={sdkType:this.sdkType,sdkVersion:this.sdkVersion};var o=e;u.default.asyncStorage||(o=null!==(i=null!=o?o:l.default.getItem(r.STATSIG_STABLE_ID_KEY))&&void 0!==i?i:this.getUUID()),o&&(this.statsigMetadata.stableID=o)}return t.prototype.saveStableID=function(){null!=this.statsigMetadata.stableID&&l.default.setItem(r.STATSIG_STABLE_ID_KEY,this.statsigMetadata.stableID)},t.prototype.initAsync=function(){return i(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return(t=this.statsigMetadata.stableID)?[3,2]:[4,u.default.getItemAsync(r.STATSIG_STABLE_ID_KEY)];case 1:t=null!=(t=e.sent())?t:this.getUUID(),e.label=2;case 2:return this.statsigMetadata.stableID=t,u.default.setItemAsync(r.STATSIG_STABLE_ID_KEY,t).catch((function(){})),[2,this]}}))}))},t.prototype.getSDKType=function(){return this.sdkType},t.prototype.getSDKVersion=function(){return this.sdkVersion},t.prototype.getStatsigMetadata=function(){return this.statsigMetadata.sdkType=this.sdkType,this.statsigMetadata.sdkVersion=this.sdkVersion,this.statsigMetadata},t.prototype.getUser=function(){return this.user},t.prototype.updateUser=function(t){this.user=t},t.prototype.setSDKPackageInfo=function(t){this.sdkType=t.sdkType,this.sdkVersion=t.sdkVersion},t.prototype.setPlatform=function(t){this.platform=t,this.updateMetadataFromNativeModules()},t.prototype.setNativeModules=function(t){this.nativeModules=t,this.updateMetadataFromNativeModules()},t.prototype.updateMetadataFromNativeModules=function(){var t,e,n,i,o,s,a;null!=this.platform&&null!=this.nativeModules&&("android"===(null===(t=this.platform.OS)||void 0===t?void 0:t.toLocaleLowerCase())?this.statsigMetadata.locale=null===(e=this.nativeModules.I18nManager)||void 0===e?void 0:e.localeIdentifier:"ios"===(null===(n=this.platform.OS)||void 0===n?void 0:n.toLocaleLowerCase())&&(this.statsigMetadata.locale=(null===(o=null===(i=this.nativeModules.SettingsManager)||void 0===i?void 0:i.settings)||void 0===o?void 0:o.AppleLocale)||(null===(a=null===(s=this.nativeModules.SettingsManager)||void 0===s?void 0:s.settings)||void 0===a?void 0:a.AppleLanguages[0])))},t.prototype.getUUID=function(){var t,e;return null!==(e=null===(t=this.reactNativeUUID)||void 0===t?void 0:t.v4())&&void 0!==e?e:(0,a.v4)()},t.prototype.setRNDeviceInfo=function(t){var e,n,i,o,s;this.statsigMetadata.appVersion=null!==(e=t.getVersion())&&void 0!==e?e:"",this.statsigMetadata.systemVersion=null!==(n=t.getSystemVersion())&&void 0!==n?n:"",this.statsigMetadata.systemName=null!==(i=t.getSystemName())&&void 0!==i?i:"",this.statsigMetadata.deviceModelName=null!==(o=t.getModel())&&void 0!==o?o:"",this.statsigMetadata.deviceModel=null!==(s=t.getDeviceId())&&void 0!==s?s:""},t.prototype.setExpoConstants=function(t){var e,n;this.statsigMetadata.appVersion=null!==(n=null!==(e=t.nativeAppVersion)&&void 0!==e?e:t.nativeBuildVersion)&&void 0!==n?n:""},t.prototype.setExpoDevice=function(t){var e,n,i,o;this.statsigMetadata.systemVersion=null!==(e=t.osVersion)&&void 0!==e?e:"",this.statsigMetadata.systemName=null!==(n=t.osName)&&void 0!==n?n:"",this.statsigMetadata.deviceModelName=null!==(i=t.modelName)&&void 0!==i?i:"",this.statsigMetadata.deviceModel=null!==(o=t.modelId)&&void 0!==o?o:""},t}();e.default=c},9951:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function a(t){try{u(i.next(t))}catch(t){s(t)}}function r(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}u((i=i.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function r(s){return function(r){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&s[0]?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],i=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,r])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(63785),r=s(n(79164)),u=n(62229),l=n(10191),d=s(n(50158)),c=s(n(19800)),f=s(n(62517)),h="statsig::",g=h+"config_exposure",p=h+"layer_exposure",v=h+"gate_exposure",y=h+"log_event_failed",E=h+"app_error",m=h+"app_metrics::page_load_time",w=h+"app_metrics::dom_interactive_time",_=h+"app_metrics::scroll_depth",I=h+"app_metrics::time_on_page_ms",S=h+"diagnostics",M=h+"default_value_type_mismatch",k=1024e3,L=function(){function t(t){this.failedLogEventCount=0,this.sdkInternal=t,this.queue=[],this.flushInterval=null,this.loggedErrors=new Set,this.failedLogEvents=[],this.exposureDedupeKeys={},this.failedLogEventCount=0,this.init()}return t.prototype.init=function(){var t=this;"undefined"!=typeof window&&"function"==typeof window.addEventListener&&(window.addEventListener("blur",(function(){return t.flush(!0)})),window.addEventListener("beforeunload",(function(){return t.flush(!0)})),window.addEventListener("load",(function(){setTimeout((function(){return t.flush()}),100),setTimeout((function(){return t.flush()}),1e3)}))),"undefined"!=typeof document&&"function"==typeof document.addEventListener&&document.addEventListener("visibilitychange",(function(){t.flush("visible"!==document.visibilityState)})),(this.sdkInternal.getOptions().getIgnoreWindowUndefined()||"undefined"!=typeof window&&null!=window)&&(this.sdkInternal.getOptions().getLocalModeEnabled()||(this.flushInterval=setInterval((function(){t.flush()}),this.sdkInternal.getOptions().getLoggingIntervalMillis()),setTimeout((function(){return t.flush()}),100),setTimeout((function(){return t.flush()}),1e3)))},t.prototype.log=function(t){if(!this.sdkInternal.getOptions().isAllLoggingDisabled()){try{if(!this.sdkInternal.getOptions().getDisableCurrentPageLogging()&&"undefined"!=typeof window&&null!=window&&"object"==typeof window.location&&"string"==typeof window.location.href){var e=window.location.href.split(/[?#]/);(null==e?void 0:e.length)>0&&t.addStatsigMetadata("currentPage",e[0])}}catch(t){}this.queue.push(t.toJsonObject()),this.queue.length>=this.sdkInternal.getOptions().getLoggingBufferMaxSize()&&this.flush()}},t.prototype.resetDedupeKeys=function(){this.exposureDedupeKeys={}},t.prototype.shouldLogExposure=function(t){var e=this.exposureDedupeKeys[t],n=Date.now();return!(null!=e&&e>=n-6e5||(this.exposureDedupeKeys[t]=n,0))},t.prototype.logGateExposure=function(t,e,n,i,o,s,a){var u=e+String(n)+i+s.reason;if(this.shouldLogExposure(u)){var l={gate:e,gateValue:String(n),ruleID:i,reason:s.reason,time:s.time};a&&(l.isManualExposure="true");var d=new r.default(v);d.setUser(t),d.setMetadata(l),d.setSecondaryExposures(o),this.log(d)}},t.prototype.logConfigExposure=function(t,e,n,i,o,s){var a=e+n+o.reason;if(this.shouldLogExposure(a)){var u={config:e,ruleID:n,reason:o.reason,time:o.time};s&&(u.isManualExposure="true");var l=new r.default(g);l.setUser(t),l.setMetadata(u),l.setSecondaryExposures(i),this.log(l)}},t.prototype.logLayerExposure=function(t,e,n,i,o,s,a,u,l){var d=[e,n,o,s,String(a),u.reason].join("|");if(this.shouldLogExposure(d)){var c={config:e,ruleID:n,allocatedExperiment:o,parameterName:s,isExplicitParameter:String(a),reason:u.reason,time:u.time};l&&(c.isManualExposure="true");var f=new r.default(p);f.setUser(t),f.setMetadata(c),f.setSecondaryExposures(i),this.log(f)}},t.prototype.logConfigDefaultValueFallback=function(t,e,n){this.logGenericEvent(M,t,e,n),this.loggedErrors.add(e),this.sdkInternal.getConsoleLogger().error(e)},t.prototype.logAppError=function(t,e,n){var i=e.substring(0,128);this.loggedErrors.has(i)||this.loggedErrors.size>10||(this.logGenericEvent(E,t,i,n),this.loggedErrors.add(i))},t.prototype.logDiagnostics=function(t,e){var n=d.default.getMarkers(e);if(!(n.length<=0)){d.default.clearContext(e);var i=this.makeDiagnosticsEvent(t,{markers:n,context:e,statsigOptions:this.sdkInternal.getOptions().getLoggingCopy()});this.log(i)}},t.prototype.logAppMetrics=function(t){var e,n=this;if("function"==typeof(null===(e=null===window||void 0===window?void 0:window.performance)||void 0===e?void 0:e.getEntriesByType)){var i=window.performance.getEntriesByType("navigation");if(i&&!(i.length<1)){var o=i[0],s={url:o.name};if(o instanceof PerformanceNavigationTiming&&(this.logGenericEvent(m,t,o.duration,s),this.logGenericEvent(w,t,o.domInteractive-o.startTime,s)),"function"==typeof(null===window||void 0===window?void 0:window.addEventListener)&&(null===document||void 0===document?void 0:document.body)){var a=0;window.addEventListener("scroll",(function(){var t=document.body.scrollHeight||1,e=Math.min(100,Math.round((window.scrollY+window.innerHeight)/t*100));e>a&&(a=e)})),window.addEventListener("beforeunload",(function(){n.logGenericEvent(_,t,a,s),n.logGenericEvent(I,t,window.performance.now(),s)}))}}}},t.prototype.logGenericEvent=function(t,e,n,i){var o=new r.default(t);return o.setUser(e),o.setValue(n),o.setMetadata(i),this.log(o),o},t.prototype.shutdown=function(){this.flushInterval&&(clearInterval(this.flushInterval),this.flushInterval=null),this.flush(!0)},t.prototype.flush=function(t){var e=this;if(void 0===t&&(t=!1),this.addErrorBoundaryDiagnostics(),0!==this.queue.length){var n=this.sdkInternal.getStatsigMetadata();null==n.sessionID&&(n.sessionID=(0,a.v4)());var s=this.queue;if(this.queue=[],!t||this.sdkInternal.getNetwork().supportsKeepalive()||"undefined"==typeof navigator||null==(null===navigator||void 0===navigator?void 0:navigator.sendBeacon))this.sdkInternal.getNetwork().postToEndpoint(u.StatsigEndpoint.Rgstr,{events:s,statsigMetadata:this.sdkInternal.getStatsigMetadata()},{retryOptions:{retryLimit:3,backoff:1e3},useKeepalive:t}).then((function(t){if(!t.ok)throw t})).catch((function(t){"function"==typeof t.text?t.text().then((function(n){e.sdkInternal.getErrorBoundary().logError(y,t,{getExtraData:function(){return i(e,void 0,void 0,(function(){return o(this,(function(t){return[2,{eventCount:s.length,error:n}]}))}))}})})):e.sdkInternal.getErrorBoundary().logError(y,t,{getExtraData:function(){return i(e,void 0,void 0,(function(){return o(this,(function(e){return[2,{eventCount:s.length,error:t.message}]}))}))}}),e.newFailedRequest(y,s)})).finally((function(){return i(e,void 0,void 0,(function(){return o(this,(function(e){return t&&(this.queue.length>0&&(this.addFailedRequest({events:this.queue,statsigMetadata:this.sdkInternal.getStatsigMetadata(),time:Date.now()}),this.queue=[]),this.saveFailedRequests()),[2]}))}))}));else this.sdkInternal.getNetwork().sendLogBeacon({events:s,statsigMetadata:this.sdkInternal.getStatsigMetadata()})||(this.queue=s.concat(this.queue),this.queue.length>0&&(this.addFailedRequest({events:this.queue,statsigMetadata:this.sdkInternal.getStatsigMetadata(),time:Date.now()}),this.queue=[]),this.saveFailedRequests())}},t.prototype.saveFailedRequests=function(){var t=this;if(this.failedLogEvents.length>0){var e=JSON.stringify(this.failedLogEvents);if(e.length>k)return void this.clearLocalStorageRequests();if(c.default.asyncStorage)return void c.default.setItemAsync(l.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY,e).catch((function(e){return t.sdkInternal.getErrorBoundary().logError("saveFailedRequests",e)}));f.default.setItem(l.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY,e)}},t.prototype.sendSavedRequests=function(){return i(this,void 0,void 0,(function(){var t,e,n,i,s,a,r,d,h=this;return o(this,(function(o){switch(o.label){case 0:return e=!1,c.default.asyncStorage?[4,c.default.getItemAsync(l.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY)]:[3,2];case 1:return t=o.sent(),[3,3];case 2:t=f.default.getItem(l.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY),o.label=3;case 3:if(null==t)return this.clearLocalStorageRequests(),[2];t.length>k&&(e=!0),n=[];try{for(n=JSON.parse(t),i=function(t){null!=t&&t.events&&Array.isArray(t.events)&&s.sdkInternal.getNetwork().postToEndpoint(u.StatsigEndpoint.Rgstr,t).then((function(t){if(!t.ok)throw Error(t.status+"")})).catch((function(){e||h.addFailedRequest(t)}))},s=this,a=0,r=n;a<r.length;a++)d=r[a],i(d)}catch(t){this.sdkInternal.getErrorBoundary().logError("sendSavedRequests",t)}finally{this.clearLocalStorageRequests()}return[2]}}))}))},t.prototype.addFailedRequest=function(t){if(!(t.time<Date.now()-432e6||this.failedLogEvents.length>100)){var e=t.events.length;this.failedLogEventCount+e>1e3||(this.failedLogEvents.push(t),this.failedLogEventCount+=e)}},t.prototype.clearLocalStorageRequests=function(){var t=this;c.default.asyncStorage?c.default.removeItemAsync(l.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY).catch((function(e){return t.sdkInternal.getErrorBoundary().logError("clearLocalStorageRequests",e)})):f.default.removeItem(l.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY)},t.prototype.newFailedRequest=function(t,e){this.loggedErrors.has(t)||(this.loggedErrors.add(t),this.failedLogEvents.push({events:e,statsigMetadata:this.sdkInternal.getStatsigMetadata(),time:Date.now()}),this.saveFailedRequests())},t.prototype.makeDiagnosticsEvent=function(t,e){var n=new r.default(S);return n.setUser(t),n.setMetadata(e),n},t.prototype.addErrorBoundaryDiagnostics=function(){if(0!==d.default.getMarkerCount("api_call")){var t=this.makeDiagnosticsEvent(this.sdkInternal.getCurrentUser(),{context:"api_call",markers:d.default.getMarkers("api_call")});this.queue.push(t),d.default.clearContext("api_call")}},t}();e.default=L}}]);
//# sourceMappingURL=https://www.scribd.com/webpack/monolith/7351.0a10575511d7f6bf3167.js.map